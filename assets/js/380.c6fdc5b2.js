(window.webpackJsonp=window.webpackJsonp||[]).push([[380],{695:function(a,s,e){"use strict";e.r(s);var t=e(7),r=Object(t.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h3",{attrs:{id:"env"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#env"}},[a._v("#")]),a._v(" ENV")]),a._v(" "),s("p",[a._v("定义环境变量")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("ENV "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("key"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("value"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 但只能设置一个环境变量")]),a._v("\nENV MY_VAR my-value\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("h3",{attrs:{id:"使用环境变量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用环境变量"}},[a._v("#")]),a._v(" 使用环境变量")]),a._v(" "),s("p",[a._v("通过 ENV 指令可以声明环境变量，可以在以下指令中使用环境变量")]),a._v(" "),s("ul",[s("li",[a._v("ADD")]),a._v(" "),s("li",[a._v("COPY")]),a._v(" "),s("li",[a._v("ENV")]),a._v(" "),s("li",[a._v("EXPOSE")]),a._v(" "),s("li",[a._v("FROM")]),a._v(" "),s("li",[a._v("LABEL")]),a._v(" "),s("li",[a._v("STOPSIGNAL")]),a._v(" "),s("li",[a._v("USER")]),a._v(" "),s("li",[a._v("VOLUME")]),a._v(" "),s("li",[a._v("WORKDIR")]),a._v(" "),s("li",[a._v("ONBUILD")])]),a._v(" "),s("h3",{attrs:{id:"使用环境变量的方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用环境变量的方式"}},[a._v("#")]),a._v(" 使用环境变量的方式")]),a._v(" "),s("p",[a._v("有两种")]),a._v(" "),s("ul",[s("li",[a._v("$variable_name")]),a._v(" "),s("li",[a._v("${variable_name}")])]),a._v(" "),s("h4",{attrs:{id:"variable-name-语法还支持以下指定的一些标准-bash-修饰符"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#variable-name-语法还支持以下指定的一些标准-bash-修饰符"}},[a._v("#")]),a._v(" ${variable_name} 语法还支持以下指定的一些标准 bash 修饰符")]),a._v(" "),s("ul",[s("li",[a._v("${variable:-word}：表示如果设置了 variable，那么结果就是那个值；如果未设置变量，则结果将是 word")]),a._v(" "),s("li",[a._v("${variable:+word}：表示如果设置了 variable，则结果为 word，否则为空字符串")]),a._v(" "),s("li",[a._v("在所有情况下， word 可以是任何字符串，包括额外的环境变量")])]),a._v(" "),s("h3",{attrs:{id:"简单栗子"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#简单栗子"}},[a._v("#")]),a._v(" 简单栗子")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("FROM busybox\nENV "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("FOO")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/bar\nWORKDIR "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${FOO}")]),a._v("   "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# WORKDIR /bar")]),a._v("\nADD "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$FOO")]),a._v("       "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ADD . /bar")]),a._v("\nCOPY "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$FOO")]),a._v(" /quux "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# COPY $FOO /quux")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])]),s("h3",{attrs:{id:"覆盖环境变量的栗子"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#覆盖环境变量的栗子"}},[a._v("#")]),a._v(" 覆盖环境变量的栗子")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("ENV "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("abc")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("hello\nENV "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("abc")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("bye "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("def")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$abc")]),a._v("\nENV "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ghi")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$abc")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("p",[a._v("def 的值是 hello，ghi 的值是 bye")]),a._v(" "),s("h4",{attrs:{id:"注意"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注意"}},[a._v("#")]),a._v(" 注意")]),a._v(" "),s("ul",[s("li",[a._v("当容器从生成的镜像运行时，使用 ENV 设置的环境变量将持续存在")]),a._v(" "),s("li",[a._v("可以使用 docker inspect 查看值，并使用"),s("code",[a._v("docker run --env <key>=<value>")]),a._v("更改它们")])]),a._v(" "),s("h3",{attrs:{id:"实际栗子"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实际栗子"}},[a._v("#")]),a._v(" 实际栗子")]),a._v(" "),s("h4",{attrs:{id:"dockerfile"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[a._v("#")]),a._v(" dockerfile")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("FROM nginx\nEXPOSE "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("80")]),a._v("\nENV "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("test")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("test1234\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("h4",{attrs:{id:"构建镜像-启动容器-inspect-查看"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#构建镜像-启动容器-inspect-查看"}},[a._v("#")]),a._v(" 构建镜像，启动容器，inspect 查看")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" build "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" test.dockerfile "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" test2 "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-P")]),a._v(" test2\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" inspect 120b\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("p",[a._v("通过 ENV 设置的环境变量是会保留到容器中的")])])}),[],!1,null,null,null);s.default=r.exports}}]);