(window.webpackJsonp=window.webpackJsonp||[]).push([[393],{708:function(s,n,a){"use strict";a.r(n);var t=a(7),e=Object(t.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"jenkins安装配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#jenkins安装配置"}},[s._v("#")]),s._v(" Jenkins安装配置")]),s._v(" "),n("h2",{attrs:{id:"_1-创建挂载目录"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-创建挂载目录"}},[s._v("#")]),s._v(" "),n("strong",[s._v("1. 创建挂载目录")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /opt/jenkins "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("777")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-R")]),s._v(" /opt/jenkins "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /opt/jenkins "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 目录设置为 777 权限，避免权限问题")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"_2-创建-docker-compose-yml-文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-创建-docker-compose-yml-文件"}},[s._v("#")]),s._v(" "),n("strong",[s._v("2. 创建 docker-compose.yml 文件")])]),s._v(" "),n("p",[n("code",[s._v("sudo vim /opt/jenkins/docker-compose.yml")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("version: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3.1'")]),s._v("\nservices:\n jenkins:\n  restart: always\n  container_name: jenkins\n  image: jenkins/jenkins:2.387.3-lts-jdk11\n  volumes:\n   - /opt/jenkins/:/var/jenkins_home\n   - /opt/jenkins/workspace/:/root/.jenkins/workspace\n   - /var/run/docker.sock:/var/run/docker.sock\n   - /usr/bin/docker:/usr/bin/docker\n   - /usr/lib/x86_64-linux-gnu/libltdl.so.7:/usr/lib/x86_64-linux-gnu/libltdl.so.7\n  ports:\n   - "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("18080")]),s._v(":8080\n   - "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15001")]),s._v(":50000\n  expose:\n   - "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("18080")]),s._v("\n   - "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("150000")]),s._v("\n  privileged: "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n  user: root\n  restart: always\n  container_name: jenkins\n  environment:\n   JAVA_OPTS: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-Djava.util.logging.config.file=/var/jenkins_home/log.properties'")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br")])]),n("h2",{attrs:{id:"说明"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#说明"}},[s._v("#")]),s._v(" "),n("strong",[s._v("说明")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("docker.sock 守护进程文件\n–restart"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always 设置自动重启命令\n–name jenkins 给这个容器起一个名称，jenkins:latest指定版本进行安装\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(" 表示shell脚本换行转义符\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h2",{attrs:{id:"栗子"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#栗子"}},[s._v("#")]),s._v(" "),n("strong",[s._v("栗子")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("yuyq@yuyqdeMacBook-Pro jenkins % "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /opt/jenkins/docker-compose.yml\nyuyq@yuyqdeMacBook-Pro jenkins % "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" up "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v("                    \nCreating network "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"jenkins_default"')]),s._v(" with the default driver\nPulling jenkins "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("jenkins/jenkins:2.319.3-lts-jdk11"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.319")]),s._v(".3-lts-jdk11: Pulling from jenkins/jenkins\n0c6b8ff8c37e: Pull complete\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n730f100cd71d: Pull complete\nDigest: sha256:c9cc19190b123077b434dd9c77b7252c3c58c3dc1add149fa9f6e2fb490526e9\nStatus: Downloaded newer image "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" jenkins/jenkins:2.319.3-lts-jdk11\nCreating jenkins "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("h2",{attrs:{id:"_3-初始化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-初始化"}},[s._v("#")]),s._v(" "),n("strong",[s._v("3. 初始化")])]),s._v(" "),n("ul",[n("li",[s._v("先修改镜像源")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-12-9-centos jenkins"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# curl -sSL https://cdn.jsdelivr.net/gh/lework/jenkins-update-center/speed-test.sh | bash")]),s._v("\n\nJenkins mirror update center speed "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Mirror Site"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nustc          "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v("  https://mirrors.ustc.edu.cn/jenkins/\nbit           "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v("  https://mirrors.bit.edu.cn/jenkins/\ntsinghua      "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v("  https://mirrors.tuna.tsinghua.edu.cn/jenkins/\ntencent       "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v("  https://mirrors.cloud.tencent.com/jenkins/\naliyun        "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v("  https://mirrors.aliyun.com/jenkins/\nhuawei        "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v("  https://mirrors.huaweicloud.com/jenkins/\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Test"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nTest File        "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" updates/current/plugin-versions.json\n\nSite Name     IPv4 address        File Size     Download Time       Download Speed\nustc          "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("202.141")]),s._v(".160.110     15M           "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".5s                "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),s._v(".6MB/s      \nbit           "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("114.247")]),s._v(".56.117      15M           "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".5s                "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(".8MB/s      \ntsinghua      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("101.6")]),s._v(".15.130        15M           "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(".5s                "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".83MB/s      \ntencent       "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("221.5")]),s._v(".97.41         15M           15s                 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".00MB/s      \naliyun        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("117.24")]),s._v(".169.241      15M           "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".7s                "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(".8MB/s      \nhuawei        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("124.70")]),s._v(".125.153      15M           "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".6s                "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(".1MB/s\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://cdn.jsdelivr.net/gh/lework/jenkins-update-center/rootCA/update-center.crt "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-O")]),s._v(" /opt/jenkins/update-center-rootCAs/update-center.crt\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s#https://updates.jenkins.io/update-center.json#https://cdn.jsdelivr.net/gh/lework/jenkins-update-center/updates/huawei/update-center.json#'")]),s._v(" /opt/jenkins/hudson.model.UpdateCenter.xml\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br")])]),n("ul",[n("li",[n("p",[s._v("启动jenkins服务后，可以在8080端口访问到jenkins\n"),n("img",{attrs:{src:"https://www.yuyanqing.cn/oss/image-bed/col/jenkins/jinkins_init_password.png",alt:"jinkins_init_password"}})])]),s._v(" "),n("li",[n("p",[s._v("然后在服务器的指定目录找到密码登录")])])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" secrets/initialAdminPassword "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 宿主机")]),s._v("\n/var/lib/jenkins/secrets/initialAdminPassword "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 容器内部")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("ul",[n("li",[n("p",[s._v("按照默认配置安装插件"),n("br"),s._v(" "),n("img",{attrs:{src:"https://www.yuyanqing.cn/oss/image-bed/col/jenkins/install_jenkins_plug.png",alt:"install_jenkins_plug"}})])]),s._v(" "),n("li",[n("p",[s._v("等待插件安装完成"),n("br"),s._v(" "),n("img",{attrs:{src:"https://www.yuyanqing.cn/oss/image-bed/col/jenkins/padding_jenkins_plug_installed.png",alt:"padding_jenkins_plug_installed"}})])]),s._v(" "),n("li",[n("p",[s._v("创建一个管理员账户，完成配置后，就可以登录 Jenkins 了")])])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://www.yuyanqing.cn/oss/image-bed/col/jenkins/init_jenkins_user.png",alt:"init_jenkins_user"}})])])}),[],!1,null,null,null);n.default=e.exports}}]);