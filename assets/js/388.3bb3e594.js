(window.webpackJsonp=window.webpackJsonp||[]).push([[388],{702:function(a,s,t){"use strict";t.r(s);var e=t(7),n=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h3",{attrs:{id:"arg"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#arg"}},[a._v("#")]),a._v(" ARG")]),a._v(" "),s("p",[a._v("作用：定义创建镜像过程中使用的变量\n格式： "),s("code",[a._v("ARG <name>[=<default value>]")])]),a._v(" "),s("h4",{attrs:{id:"详解"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#详解"}},[a._v("#")]),a._v(" 详解")]),a._v(" "),s("ul",[s("li",[a._v("在执行 docker build 时，可以通过 "),s("code",[a._v("--build-arg <参数名>=<值>")]),a._v(" 来为声明的变量赋值")]),a._v(" "),s("li",[a._v("当镜像编译成功后，ARG 指定的变量将不再存在（ENV指定的变量将在镜像中保留）")]),a._v(" "),s("li",[a._v("Docker内置了一些镜像创建变量，用户可以直接使用而无须声明，包括（不区分大小写）HTTP_PROXY、HTTPS_PROXY、FTP_PROXY、NO_PROXY")])]),a._v(" "),s("h4",{attrs:{id:"arg-和-env-的区别"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#arg-和-env-的区别"}},[a._v("#")]),a._v(" ARG 和 ENV 的区别")]),a._v(" "),s("ul",[s("li",[a._v("ARG 定义的变量只会存在于镜像构建过程，启动容器后并不保留这些变量")]),a._v(" "),s("li",[a._v("ENV 定义的变量在启动容器后仍然保留")])]),a._v(" "),s("h4",{attrs:{id:"注意"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注意"}},[a._v("#")]),a._v(" 注意")]),a._v(" "),s("p",[a._v("不要通过 ARG 保存密码之类的信息，因为  docker history  还是可以看到所有值的")]),a._v(" "),s("h3",{attrs:{id:"arg-指令有生效范围"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#arg-指令有生效范围"}},[a._v("#")]),a._v(" ARG 指令有生效范围")]),a._v(" "),s("p",[a._v("如果在 FROM 指令之前指定，那么只能用于 FROM 指令中")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("ARG "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DOCKER_USERNAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("library\n\nFROM "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${DOCKER_USERNAME}")]),a._v("/alpine\n\nRUN "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("set")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-x")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${DOCKER_USERNAME}")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])]),s("ul",[s("li",[a._v(" 使用上述 Dockerfile 会发现无法输出 ${DOCKER_USERNAME} 变量的值")]),a._v(" "),s("li",[a._v("要想正常输出，必须在 FROM 之后再次指定 ARG")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 只在 FROM 中生效")]),a._v("\nARG "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DOCKER_USERNAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("library\n\nFROM "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${DOCKER_USERNAME}")]),a._v("/alpine\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 要想在 FROM 之后使用，必须再次指定")]),a._v("\nARG "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DOCKER_USERNAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("library\n\nRUN "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("set")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-x")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${DOCKER_USERNAME}")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br")])]),s("p",[a._v("多阶段构建的时候，ARG 定义的变量，每个 FROM 都能用")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 这个变量在每个 FROM 中都生效")]),a._v("\nARG "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DOCKER_USERNAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("library\n\nFROM "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${DOCKER_USERNAME}")]),a._v("/alpine\n\nRUN "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("set")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-x")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n\nFROM "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${DOCKER_USERNAME}")]),a._v("/alpine\n\nRUN "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("set")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-x")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br")])]),s("h3",{attrs:{id:"arg-其他用法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#arg-其他用法"}},[a._v("#")]),a._v(" ARG 其他用法")]),a._v(" "),s("p",[a._v("暂时不举例了，感觉应该不会用很多\n"),s("a",{attrs:{href:"https://docs.docker.com/engine/reference/builder/#arg",target:"_blank",rel:"noopener"}},[a._v("https://docs.docker.com/engine/reference/builder/#arg")])])])}),[],!1,null,null,null);s.default=n.exports}}]);